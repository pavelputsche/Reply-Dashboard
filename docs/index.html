<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reply Banking Dashboard</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <meta name="theme-color" content="#6366f1">
    <!-- Temporary inline override to ensure permission panels stay hidden until final styles settle -->
    <style>
        /* Temporary: force permission lists hidden on dashboard */
        .permission-group .permission-list { display: none !important; }
    </style>
</head>
<body>
    <nav id="sidebar" class="sidebar">
        <div class="sidebar-header">
            <h2>Eurovia Bank</h2>
            <button id="closeSidebar">×</button>
        </div>
        <ul>
            <li><a href="#dashboard"><i class="fas fa-home"></i>Übersicht</a></li>
            <li><a href="#accounts"><i class="fas fa-wallet"></i>Konten</a></li>
            <li><a href="#profile"><i class="fas fa-user"></i>Profil</a></li>
            <li><a href="#privacy"><i class="fas fa-shield-alt"></i>Datenschutz</a></li>
            <li><a href="#permissions"><i class="fas fa-key"></i>Berechtigungen</a></li>
            <li><a href="#messages" class="has-badge">
                <i class="fas fa-envelope"></i>Nachrichten
                <span class="notification-badge">2</span>
            </a></li>
        </ul>
    </nav>
    <div class="main-content">
        <header>
            <button id="burgerMenu" class="burger">☰</button>
            <h1>Übersicht</h1>
        </header>
        <section id="dashboard" class="dashboard-section">
            <div class="accounts-overview">
                <h2>Kontenübersicht</h2>
                <div class="accounts-grid">
                    <div class="account-card checking">
                        <div class="account-icon"><i class="fas fa-wallet"></i></div>
                        <div class="account-details">
                            <div class="account-type">Girokonto</div>
                            <div class="account-id">**** 4385</div>
                            <div class="balance">5.200,00 €</div>
                        </div>
                        <div class="account-actions">
                            <button class="action-btn" title="Überweisung"><i class="fas fa-exchange-alt"></i></button>
                            <button class="action-btn" title="Kontoauszug"><i class="fas fa-file-invoice"></i></button>
                        </div>
                    </div>
                    <div class="account-card savings">
                        <div class="account-icon"><i class="fas fa-piggy-bank"></i></div>
                        <div class="account-details">
                            <div class="account-type">Sparkonto</div>
                            <div class="account-id">**** 7829</div>
                            <div class="balance">12.800,00 €</div>
                        </div>
                        <div class="account-actions">
                            <button class="action-btn" title="Überweisung"><i class="fas fa-exchange-alt"></i></button>
                            <button class="action-btn" title="Kontoauszug"><i class="fas fa-file-invoice"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="recent-transactions">
                <h2>Letzte Transaktionen</h2>
                <div class="transaction-header">
                    <span class="transaction-date">Datum</span>
                    <span class="transaction-description">Beschreibung</span>
                    <span class="transaction-account">Konto</span>
                    <span class="transaction-amount">Betrag</span>
                </div>
                <ul>
                    <li class="debit">
                        <span class="transaction-date">03.10.2025</span>
                        <span class="transaction-description">
                            <i class="fas fa-shopping-cart"></i>
                            REWE Markt GmbH
                            <span class="transaction-id">TX-89321</span>
                        </span>
                        <span class="transaction-account">GIRO *4385</span>
                        <span class="transaction-amount">-186,42 €</span>
                    </li>
                    <li class="credit">
                        <span class="transaction-date">02.10.2025</span>
                        <span class="transaction-description">
                            <i class="fas fa-building"></i>
                            Gehalt - Siemens AG
                            <span class="transaction-id">TX-89320</span>
                        </span>
                        <span class="transaction-account">GIRO *4385</span>
                        <span class="transaction-amount">+3.250,00 €</span>
                    </li>
                    <li class="debit">
                        <span class="transaction-date">02.10.2025</span>
                        <span class="transaction-description">
                            <i class="fas fa-home"></i>
                            Mietzahlung
                            <span class="transaction-id">TX-89319</span>
                        </span>
                        <span class="transaction-account">GIRO *4385</span>
                        <span class="transaction-amount">-1.850,00 €</span>
                    </li>
                    <li class="debit">
                        <span class="transaction-date">01.10.2025</span>
                        <span class="transaction-description">
                            <i class="fas fa-car"></i>
                            ARAL Tankstelle
                            <span class="transaction-id">TX-89318</span>
                        </span>
                        <span class="transaction-account">GIRO *4385</span>
                        <span class="transaction-amount">-65,23 €</span>
                    </li>
                    <li class="transfer">
                        <span class="transaction-date">01.10.2025</span>
                        <span class="transaction-description">
                            <i class="fas fa-exchange-alt"></i>
                            Überweisung zum Sparkonto
                            <span class="transaction-id">TX-89317</span>
                        </span>
                        <span class="transaction-account">SPAR *7829</span>
                        <span class="transaction-amount">-500,00 €</span>
                    </li>
                </ul>
            </div>
            <div class="quick-actions">
                <h2>Schnellzugriff</h2>
                <button>Überweisung</button>
            </div>
        </section>
        <section id="profile" class="dashboard-section">
            <h2>Profil-Einstellungen</h2>
            <div class="profile-info">
                <p>Name: Max Mustermann</p>
                <p>E-Mail: max.mustermann@email.de</p>
            </div>
        </section>
        <section id="privacy" class="dashboard-section">
            <h2>Datenschutz-Einstellungen</h2>
            <label><input type="checkbox" checked> Kontostand ausblenden</label><br>
            <label><input type="checkbox"> Zwei-Faktor-Authentifizierung aktivieren</label>
        </section>
        <section id="permissions" class="dashboard-section">
            <h2>Berechtigungsverwaltung</h2>
            <ul id="permissionsList">
                <li data-id="1" class="permission-group">
                    <div class="group-header">
                        <div class="company-container">
                            <div class="company-logo">
                                <img src="assets/drv-logo.png" alt="Deutsche Rentenversicherung" class="logo-image">
                            </div>
                            <div class="company-details">
                                <span class="company">Deutsche Rentenversicherung</span>
                                <span class="verified-badge" title="Verifizierte Institution">
                                    <i class="fas fa-check-circle"></i>
                                </span>
                            </div>
                        </div>
                        <div class="summary-box" title="Alle Berechtigungen anzeigen">
                            <div class="summary-text">Alle Berechtigungen anzeigen</div>
                            <button class="open-all small" aria-label="Alle Berechtigungen anzeigen">Anzeigen</button>
                        </div>
                        <button class="info-btn sage-green" 
                            data-tooltip="Informationen zur Institution und deren Berechtigungen"
                            data-company="pension-fund"
                            onclick="showCompanyInfo(this)">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                    <ul class="permission-list">
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-wallet"></i>Kontostand einsehen</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('drv-balance')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-chart-line"></i>Investitionen einsehen</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('drv-investments')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-history"></i>Transaktionshistorie</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('drv-history')">Widerrufen</button>
                        </li>
                    </ul>
                </li>
                <li data-id="2" class="permission-group">
                    <div class="group-header">
                        <div class="company-container">
                            <div class="company-logo tk-logo">
                                <span>T</span>
                            </div>
                            <div class="company-details">
                                <span class="company">Techniker Krankenkasse</span>
                                <span class="verified-badge" title="Verifizierte Institution">
                                    <i class="fas fa-check-circle"></i>
                                </span>
                            </div>
                        </div>
                        <button class="info-btn sage-green" 
                            data-tooltip="Informationen zur Institution und deren Berechtigungen"
                            data-company="health-insurance"
                            onclick="showCompanyInfo(this)">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                    <ul class="permission-list">
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-user-shield"></i>Persönliche Daten einsehen</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('tk-personal')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-file-medical"></i>Krankenversicherungsdaten</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('tk-insurance')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-notes-medical"></i>Behandlungshistorie</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('tk-history')">Widerrufen</button>
                        </li>
                    </ul>
                </li>
                <li data-id="3" class="permission-group">
                    <div class="group-header">
                        <div class="company-container">
                            <div class="company-logo schufa-logo">
                                <span>S</span>
                            </div>
                            <div class="company-details">
                                <span class="company">SCHUFA</span>
                                <span class="verified-badge" title="Verifizierte Institution">
                                    <i class="fas fa-check-circle"></i>
                                </span>
                            </div>
                        </div>
                        <button class="info-btn sage-green" 
                            data-tooltip="Informationen zur Institution und deren Berechtigungen"
                            data-company="schufa"
                            onclick="showCompanyInfo(this)">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                    <ul class="permission-list">
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-credit-score"></i>Bonitätsscore einsehen</span>
                                <span class="access-details">Zugriff seit: 01.09.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('schufa-score')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-history"></i>Kredithistorie</span>
                                <span class="access-details">Zugriff seit: 01.09.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('schufa-history')">Widerrufen</button>
                        </li>
                    </ul>
                </li>
                <li data-id="4" class="permission-group">
                    <div class="group-header">
                        <div class="company-container">
                            <div class="company-logo db-logo">
                                <span>DB</span>
                            </div>
                            <div class="company-details">
                                <span class="company">Deutsche Bank</span>
                                <span class="verified-badge" title="Verifizierte Institution">
                                    <i class="fas fa-check-circle"></i>
                                </span>
                            </div>
                        </div>
                        <button class="info-btn sage-green" 
                            data-tooltip="Informationen zur Institution und deren Berechtigungen"
                            data-company="deutsche-bank"
                            onclick="showCompanyInfo(this)">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                    <ul class="permission-list">
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-exchange-alt"></i>Überweisungshistorie</span>
                                <span class="access-details">Zugriff seit: 15.09.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('db-transfers')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-piggy-bank"></i>Sparkonten einsehen</span>
                                <span class="access-details">Zugriff seit: 15.09.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('db-savings')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-credit-card"></i>Kreditkartendaten</span>
                                <span class="access-details">Zugriff seit: 15.09.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('db-credit')">Widerrufen</button>
                        </li>
                    </ul>
                </li>
                <li data-id="5" class="permission-group">
                    <div class="group-header">
                        <div class="company-container">
                            <div class="company-logo blackrock-logo">
                                <span>BR</span>
                            </div>
                            <div class="company-details">
                                <span class="company">BlackRock Investment Management</span>
                                <span class="verified-badge" title="Verifizierte Institution">
                                    <i class="fas fa-check-circle"></i>
                                </span>
                            </div>
                        </div>
                        <button class="info-btn sage-green" 
                            data-tooltip="Informationen zur Institution und deren Berechtigungen"
                            data-company="blackrock"
                            onclick="showCompanyInfo(this)">
                            <i class="fas fa-info-circle"></i>
                        </button>
                    </div>
                    <ul class="permission-list">
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-chart-pie"></i>Portfolio-Übersicht</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('br-portfolio')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-money-bill-trend-up"></i>Anlagepräferenzen</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('br-preferences')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-file-invoice-dollar"></i>Steuerrelevante Daten</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('br-tax')">Widerrufen</button>
                        </li>
                        <li class="permission-item">
                            <div class="permission-info">
                                <span class="access-type"><i class="fas fa-handshake"></i>Handelsaktivitäten</span>
                                <span class="access-details">Zugriff seit: 01.10.2025</span>
                            </div>
                            <button class="revoke-btn small" onclick="togglePermission('br-trading')">Widerrufen</button>
                        </li>
                    </ul>
                </li>
            </ul>
            
            <!-- Confirmation Dialog -->
            <div id="confirmationDialog" class="dialog">
                <div class="dialog-content">
                    <h3>Aktion bestätigen</h3>
                    <p id="dialogMessage">Möchten Sie diese Berechtigung wirklich widerrufen?</p>
                    <div class="dialog-buttons">
                        <button onclick="confirmAction(true)" class="btn-confirm">Ja</button>
                        <button onclick="confirmAction(false)" class="btn-cancel">Nein</button>
                    </div>
                </div>
            </div>
        </section>
        <section id="messages" class="dashboard-section">
            <h2>Nachrichten</h2>
            <div class="message">
                <div class="message-content">
                    <div class="company-container">
                        <div class="company-logo">
                            <svg viewBox="0 0 40 40">
                                <circle cx="20" cy="20" r="20" fill="#f0f0f0"/>
                                <circle cx="20" cy="20" r="18" fill="#0067b2"/>
                                <text x="20" y="27" font-family="Arial" font-size="18" fill="white" text-anchor="middle" font-weight="bold">R</text>
                            </svg>
                        </div>
                        <div class="company-details">
                            <strong>Deutsche Rentenversicherung</strong>
                            <span class="verified-badge" title="Verifizierte Institution">
                                <i class="fas fa-check-circle"></i>
                            </span>
                        </div>
                    </div>
                    <p>möchte Zugriff auf Ihre Kontoinformationen.</p>
                    <button class="info-btn sage-green" 
                        data-tooltip="Die Deutsche Rentenversicherung benötigt Zugriff auf: &#10;• Kontostand &#10;• Monatliche Einzahlungen &#10;• Verwendungszweck der Rentenbeiträge"
                        data-company="pension-fund"
                        onclick="showCompanyInfo(this)">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
                <div class="message-actions">
                    <button class="btn-confirm">Zugriff gewähren</button>
                    <button class="btn-cancel">Ablehnen</button>
                </div>
            </div>
        </section>
        <!-- Company Permissions Detail Page (tabs) -->
        <section id="companyPermissions" class="dashboard-section" style="display:none;">
            <div class="company-permissions-container">
                <button class="back-btn" onclick="closeCompanyPermissionsPage()">← Zurück</button>
                <h2 id="companyPermissionsTitle">Berechtigungen</h2>

                <div id="permissionsTabs" class="permissions-tabs" role="tablist" aria-label="Berechtigungen">
                    <!-- tabs injected here -->
                </div>

                <div id="permissionsTabpanels" class="permissions-tabpanels">
                    <!-- tab panels injected here -->
                </div>
            </div>
        </section>
    </div>
    <!-- Company Info Dialog -->
    <div id="companyInfoDialog" class="dialog">
        <div class="dialog-content company-info">
            <button class="close-btn" onclick="closeCompanyInfo()">×</button>
            <div id="companyInfoContent">
                <h3 id="companyInfoTitle">Unternehmens-Information</h3>
                <div class="info-section">
                    <h4>Datennutzungsrichtlinie</h4>
                    <p id="dataUsagePolicy"></p>
                </div>
                <div class="info-section">
                    <h4>Zugriffsinformationen</h4>
                    <p id="accessDetails"></p>
                </div>
                <div class="info-section">
                    <h4>Sicherheitsmaßnahmen</h4>
                    <p id="securityMeasures"></p>
                </div>
                <div class="info-section">
                    <h4>Kontaktinformationen</h4>
                    <p id="contactInfo"></p>
                </div>
                <div class="info-section">
                    <a href="#" id="moreInfoLink" class="more-info-link" target="_blank">
                        <i class="fas fa-external-link-alt"></i>
                        Hier klicken für detailliertere Informationen
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Permission Modal -->
    <div id="permissionModal" class="dialog">
        <div class="dialog-content permissions-modal">
            <button class="close-btn" onclick="closePermissionModal()">×</button>
            <h3 id="permissionModalTitle">Berechtigungen</h3>
            <ul id="permissionModalList" class="modal-permission-list"></ul>
        </div>
    </div>
    <script src="app.js"></script>
</body>
</html>
